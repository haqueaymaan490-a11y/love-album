<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Aymaan ‚ù§Ô∏è Pariza ‚Äî Our Love Album</title>
<link rel="icon" href="data:," />
<style>
  :root{
    --bg-pink: #fff5f8;
    --card-pink: #fff;
    --text-pink: #4a2e3a;
    --accent-pink: #f6a6c2;
    --bg-night: #071027;
    --card-night: #0e1b34;
    --text-night: #e7f0ff;
    --accent-night: #9fd3ff;
    --polaroid-shadow: 0 12px 30px rgba(17,12,20,0.12);
    --transition: 280ms cubic-bezier(.2,.9,.3,1);
  }
  /* base */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: "Georgia", serif;
    background:var(--bg-pink);
    color:var(--text-pink);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow-x:hidden;
  }

  /* page transitions */
  .fade-in{
    animation:pageFadeIn .45s var(--transition) both;
  }
  @keyframes pageFadeIn{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }

  header{
    text-align:center;
    padding:2.2rem 1rem 0.6rem;
    position:relative;
    z-index:5;
  }
  header h1{
    margin:0; font-size:2.2rem; letter-spacing:1px;
    text-shadow: 0 4px 18px rgba(246,166,194,0.12);
  }
  header p{margin:.4rem 0 0; opacity:.9; font-size:1rem}

  /* controls */
  .controls{
    max-width:1100px;
    margin:1rem auto;
    display:flex;
    gap:0.6rem;
    align-items:center;
    justify-content:center;
    flex-wrap:wrap;
    z-index:5;
    position:relative;
  }
  .btn{
    background:var(--card-pink);
    color:var(--text-pink);
    padding:.6rem .9rem;
    border-radius:10px;
    text-decoration:none;
    border:0;
    cursor:pointer;
    font-size:0.95rem;
    box-shadow:var(--polaroid-shadow);
    transition:transform .18s ease;
  }
  .btn:active{transform:translateY(1px)}
  .btn.secondary{background:transparent; border:1px solid rgba(74,59,69,0.08)}

  /* gallery */
  .wrap{
    max-width:1100px;
    margin:0 auto 2.2rem;
    padding:1rem;
  }
  .gallery{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:1rem;
  }

  /* polaroid card */
  .polaroid{
    background:var(--card-pink);
    border-radius:12px;
    padding:10px 10px 16px;
    box-shadow:var(--polaroid-shadow);
    display:flex;
    flex-direction:column;
    align-items:center;
    transition:transform .28s ease, box-shadow .28s ease;
    position:relative;
    overflow:visible;
  }
  .polaroid:hover{transform:translateY(-6px)}
  .photo{
    width:100%;
    height:220px;
    object-fit:cover;
    border-radius:6px;
    display:block;
    box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    transition: filter .28s linear, box-shadow .28s linear, transform .28s ease;
    cursor:pointer;
  }
  .polaroid:hover .photo{
    filter: drop-shadow(0 8px 26px rgba(159,211,255,0.12));
    transform:translateY(-6px) scale(1.02);
  }
  .meta{
    width:100%;
    padding-top:10px;
    text-align:center;
    font-size:0.95rem;
    color:var(--text-pink);
  }
  .polaroid .date{
    display:block; font-size:0.82rem; opacity:0.8; margin-top:6px;
  }

  /* intro overlay */
  #intro{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
    background:linear-gradient(180deg, rgba(255,245,249,0.95), rgba(255,245,249,0.85));
    z-index:15; transition:opacity .3s ease; will-change:opacity;
    flex-direction:column; gap:12px; padding:2rem;
  }
  #intro.hidden{opacity:0; pointer-events:none; transform:scale(.998)}
  .intro-card{
    background:transparent; text-align:center;
  }
  .intro-name{
    font-size:2.8rem; font-weight:700;
    text-shadow: 0 10px 30px rgba(246,166,194,0.18);
    animation:glow 3.6s ease-in-out infinite;
  }
  .intro-quote{font-size:1.05rem; opacity:0.95; margin-top:6px; font-style:italic}
  @keyframes glow {
    0% { text-shadow: 0 6px 12px rgba(246,166,194,0.08); transform:translateY(0) }
    50% { text-shadow: 0 18px 46px rgba(246,166,194,0.20); transform:translateY(-4px) }
    100% { text-shadow: 0 6px 12px rgba(246,166,194,0.08); transform:translateY(0) }
  }
  .skip{
    margin-top:12px; background:transparent; border:1px solid rgba(74,59,69,0.06); padding:.5rem .8rem; border-radius:8px; cursor:pointer;
  }

  /* modal (love letter & quiz & surprise) */
  .modal{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
    background:rgba(3,6,10,0.55); z-index:40; opacity:0; visibility:hidden; transition:opacity .26s ease;
    padding:20px;
  }
  .modal.open{opacity:1; visibility:visible}
  .modal-card{
    width:min(780px,96%); background:var(--card-pink); border-radius:14px; padding:1.2rem; box-shadow:0 18px 60px rgba(6,6,12,0.28);
    transform:translateY(8px); transition:transform .26s ease;
  }
  .modal.open .modal-card{transform:translateY(0)}
  .close-x{float:right; cursor:pointer; font-size:1.05rem; opacity:0.8; margin-top:-6px}
  .letter{font-family: "Brush Script MT", "Lucida Handwriting", Georgia, serif; font-size:1.12rem; line-height:1.6; color:var(--text-pink)}

  /* surprise message popup */
  .surprise{
    position:fixed; left:50%; transform:translateX(-50%); top:12%;
    background:rgba(255,255,255,0.96); padding:.9rem 1.1rem; border-radius:12px; box-shadow:0 10px 40px rgba(0,0,0,0.12);
    z-index:60; opacity:0; pointer-events:none; transition:opacity .35s ease, transform .35s cubic-bezier(.2,.9,.3,1);
  }
  .surprise.show{opacity:1; pointer-events:auto; transform:translateX(-50%) translateY(0)}
  .surprise p{margin:0; font-size:1.02rem; font-weight:600; color:#222}

  /* theme toggle & heart button */
  .top-right{
    position:fixed; right:14px; top:14px; z-index:55; display:flex; gap:10px; align-items:center;
  }
  .heart-btn{
    background:linear-gradient(180deg,#ff8fb1,#ff5b8a); color:#fff; width:48px; height:48px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow:0 8px 30px rgba(255,91,138,0.18);
  }
  .theme-btn{background:rgba(255,255,255,0.9); padding:.5rem .7rem; border-radius:10px; cursor:pointer; box-shadow:var(--polaroid-shadow)}

  /* stars layer (night) */
  .stars{
    position:fixed; inset:0; pointer-events:none; z-index:2; opacity:0; transition:opacity .5s ease;
  }
  .stars.visible{opacity:1}
  .star{position:absolute; width:2px; height:2px; background:rgba(255,255,255,0.9); border-radius:50%; box-shadow:0 0 6px rgba(255,255,255,0.7); opacity:0.9; animation:twinkle 3s infinite;}
  @keyframes twinkle{
    0%{opacity:.1; transform:scale(.9)}
    50%{opacity:1; transform:scale(1.4)}
    100%{opacity:.1; transform:scale(.9)}
  }

  /* floating hearts */
  .hearts{
    position:fixed; bottom:-20%; left:0; right:0; pointer-events:none; z-index:1; overflow:visible;
  }
  .heart{
    position:absolute; font-size:18px; opacity:0.12; transform:translateY(0); animation:rise linear infinite;
    text-shadow:0 4px 10px rgba(0,0,0,0.06);
  }
  @keyframes rise{
    0%{ transform:translateY(0) scale(0.9); opacity:0.12 }
    50%{ opacity:0.22 }
    100%{ transform:translateY(-140vh) scale(1.2); opacity:0 }
  }

  /* lightbox */
  .lightbox{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(2,3,6,0.7); z-index:70; opacity:0; visibility:hidden; transition:opacity .2s;
  }
  .lightbox.open{opacity:1; visibility:visible}
  .lightbox img{max-width:92vw; max-height:82vh; border-radius:10px}

  /* small screens */
  @media (max-width:560px){
    .photo{height:160px}
    .intro-name{font-size:1.8rem}
    .modal-card{padding:.9rem}
  }
</style>
</head>
<body class="fade-in">

  <!-- Intro overlay -->
  <section id="intro" role="dialog" aria-modal="true">
    <div class="intro-card">
      <div class="intro-name">Aymaan ‚ù§Ô∏è Pariza</div>
      <div class="intro-quote">‚ÄúFive months of love, laughter, and forever to go.‚Äù</div>
      <div style="margin-top:14px; display:flex; gap:8px; justify-content:center;">
        <button class="btn" id="enterBtn">Enter our album</button>
        <button class="skip" id="skipIntro">Skip</button>
      </div>
    </div>
  </section>

  <!-- stars layer -->
  <div class="stars" id="starsLayer" aria-hidden="true"></div>

  <!-- floating hearts -->
  <div class="hearts" id="heartsLayer" aria-hidden="true"></div>

  <!-- top right action buttons -->
  <div class="top-right">
    <div class="theme-btn btn" id="themeToggle" title="Switch theme">Night Mode</div>
    <div class="heart-btn" id="surpriseBtn" title="A surprise for Pariza">‚ô•</div>
  </div>

  <header>
    <h1>Our Love Album</h1>
    <p>A growing garden of our moments ‚Äî for you, Pariza</p>
  </header>

  <div class="controls">
    <label class="btn" for="fileInput" title="Add photos from this device">+ Add from device</label>
    <input id="fileInput" type="file" accept="image/*" multiple style="display:none">
    <button class="btn secondary" id="openLetterBtn">Read My Letter üíå</button>
    <button class="btn" id="openQuizBtn">Memory Quiz üé≤</button>
    <button class="btn secondary" id="startSlideshow">Slideshow ‚ñ∂</button>
    <button class="btn" id="downloadBtn" title="Download visible photos (not implemented server-side)">Download All</button>
  </div>

  <main class="wrap fade-in">
    <section class="gallery" id="gallery" aria-live="polite" aria-label="Photo gallery">
      <!-- fallback static images (keep these or replace) -->
      <div class="polaroid">
        <img class="photo" src="images/1.jpg" alt="Memory 1">
        <div class="meta">Memory 1 <span class="date">‚Äî our cuddle session</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/2.jpg" alt="Memory 2">
        <div class="meta">Memory 2 <span class="date">‚Äî C PARISS</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/3.jpg" alt="Memory 3">
        <div class="meta">Memory 3 <span class="date">‚Äî IG AMRA DRUNK</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/4.jpg" alt="Memory 4">
        <div class="meta">Memory 4 <span class="date">‚Äî CHATIME DATE</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/5.jpg" alt="Memory 5">
        <div class="meta">Memory 5 <span class="date">‚Äî FIRST CONCERT TOGETHER</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/6.jpg" alt="Memory 6">
        <div class="meta">Memory 6 <span class="date">‚Äî CHATIME PT2</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/7.jpg" alt="Memory 7">
        <div class="meta">Memory 7 <span class="date">‚Äî RIB CRUSHING HUG</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/8.jpg" alt="Memory 8">
        <div class="meta">Memory 8 <span class="date">‚Äî BESH CUTE LAGCHE</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/9.jpg" alt="Memory 9">
        <div class="meta">Memory 9 <span class="date">‚Äî CONCERT PT2</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/10.jpg" alt="Memory 10">
        <div class="meta">Memory 10 <span class="date">‚Äî CHATIME P3</span></div>
      </div>
      <div class="polaroid">
        <img class="photo" src="images/11.jpg" alt="Memory 11">
        <div class="meta">Memory 11 <span class="date">‚Äî I HOPE OUR BABY LOOKS LIKE THIS</span></div>
      </div>
    </section>
  </main>

  <footer style="text-align:center;color:rgba(0,0,0,0.45);padding-bottom:28px">
    Made with love ‚Äî Aymaan ü§ç
  </footer>

  <!-- Surprise message popup -->
  <div class="surprise" id="surprisePopup" aria-hidden="true"><p id="surpriseText"></p></div>

  <!-- Love letter modal -->
  <div class="modal" id="letterModal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <strong style="font-size:1.05rem">A letter for Pariza</strong>
        <div class="close-x" id="closeLetter">‚úï</div>
      </div>
      <div style="margin-top:8px" class="letter">
        <p><strong>My dearest Pariza,</strong></p>
        <p>Every moment with you feels like a quiet miracle ‚Äî the kind that turns ordinary days into something unforgettable. Your smile, your laugh, your love‚Ä¶ they‚Äôve become my favorite parts of every day.</p>
        <p>Thank you for choosing me, for believing in us, and for being my home in every way that matters.</p>
        <p style="margin-top:10px">Forever yours,<br><strong>Aymaan ü§ç</strong></p>
      </div>
    </div>
  </div>

  <!-- Quiz modal -->
  <div class="modal" id="quizModal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" id="quizCard">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <strong style="font-size:1.05rem">Memory Quiz</strong>
        <div class="close-x" id="closeQuiz">‚úï</div>
      </div>
      <div id="quizContent" style="margin-top:10px">
        <!-- quiz will be injected here -->
      </div>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <img src="" alt="Large photo view" id="lightboxImg">
  </div>

<script>
(function(){
  // basic DOM refs
  const intro = document.getElementById('intro');
  const enterBtn = document.getElementById('enterBtn');
  const skipIntro = document.getElementById('skipIntro');
  const starsLayer = document.getElementById('starsLayer');
  const heartsLayer = document.getElementById('heartsLayer');
  const themeToggle = document.getElementById('themeToggle');
  const surpriseBtn = document.getElementById('surpriseBtn');
  const surprisePopup = document.getElementById('surprisePopup');
  const surpriseText = document.getElementById('surpriseText');
  const openLetterBtn = document.getElementById('openLetterBtn');
  const letterModal = document.getElementById('letterModal');
  const closeLetter = document.getElementById('closeLetter');
  const fileInput = document.getElementById('fileInput');
  const gallery = document.getElementById('gallery');
  const startSlideshow = document.getElementById('startSlideshow');
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightboxImg');
  const openQuizBtn = document.getElementById('openQuizBtn');
  const quizModal = document.getElementById('quizModal');
  const quizContent = document.getElementById('quizContent');
  const closeQuiz = document.getElementById('closeQuiz');

  // names and messages
  const YOU = 'Aymaan';
  const HER = 'Pariza';
  // surprise messages (from you)
  const SURPRISE_MESSAGES = [
    "You‚Äôre my favorite reason to smile, always.",
    "Every song makes sense when it‚Äôs about you.",
    "You feel like home ‚Äî soft, warm, and safe.",
    "If I could choose again, I‚Äôd still choose you every time.",
    "Five months with you feel like five heartbeats ‚Äî quick, beautiful, unforgettable.",
    "You and I ‚Äî our little forever in the making.",
    "Your laugh is my favorite sound in the world."
  ];

  // localStorage key for added images
  const STORAGE_KEY = 'album_user_images_v2';

  // theme state
  let theme = 'pink'; // 'pink' or 'night'
  let slideshowTimer = null;

  // -- Intro logic --
  function hideIntro(){
    intro.classList.add('hidden');
    setTimeout(()=> { intro.style.display = 'none'; }, 320);
  }
  enterBtn.addEventListener('click', ()=> { hideIntro(); });
  skipIntro.addEventListener('click', ()=> { hideIntro(); });

  // auto-hide intro after 4s
  setTimeout(()=>{ if (!intro.classList.contains('hidden')) hideIntro(); }, 4200);

  // -- Stars generator (night theme) --
  function makeStars(count=60){
    starsLayer.innerHTML = '';
    for (let i=0;i<count;i++){
      const s = document.createElement('div');
      s.className = 'star';
      const left = Math.random()*100;
      const top = Math.random()*100;
      const dur = 2 + Math.random()*3;
      s.style.left = left + 'vw';
      s.style.top = top + 'vh';
      s.style.width = `${1 + Math.random()*2}px`;
      s.style.height = s.style.width;
      s.style.animationDuration = (2+Math.random()*4)+'s';
      s.style.opacity = 0.2 + Math.random()*0.9;
      starsLayer.appendChild(s);
    }
  }
  makeStars(48);

  // -- Floating hearts --
  function makeHearts(count=12){
    heartsLayer.innerHTML = '';
    for (let i=0;i<count;i++){
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = '‚ù§';
      const left = Math.random()*100;
      h.style.left = left + 'vw';
      h.style.bottom = (-10 - Math.random()*10) + 'vh';
      const delay = Math.random()*6;
      const dur = 10 + Math.random()*14;
      h.style.animationDuration = dur + 's';
      h.style.animationDelay = delay + 's';
      h.style.fontSize = (12 + Math.random()*32) + 'px';
      h.style.opacity = 0.08 + Math.random()*0.2;
      heartsLayer.appendChild(h);
    }
  }
  makeHearts(16);

  // -- Theme toggle --
  function applyTheme(t){
    theme = t;
    if (t === 'night'){
      document.body.style.background = 'linear-gradient(180deg,#071027,#08122a 60%)';
      document.body.style.color = getComputedStyle(document.documentElement).getPropertyValue('--text-night');
      document.querySelectorAll('.polaroid').forEach(p => p.style.background = 'var(--card-night)');
      document.querySelectorAll('.meta').forEach(m => m.style.color = 'var(--text-night)');
      themeToggle.textContent = 'Pink Mode';
      starsLayer.classList.add('visible');
      heartsLayer.style.opacity = '0.08';
    } else {
      document.body.style.background = 'linear-gradient(180deg,var(--bg-pink),#fff)';
      document.body.style.color = getComputedStyle(document.documentElement).getPropertyValue('--text-pink');
      document.querySelectorAll('.polaroid').forEach(p => p.style.background = 'var(--card-pink)');
      document.querySelectorAll('.meta').forEach(m => m.style.color = 'var(--text-pink)');
      themeToggle.textContent = 'Night Mode';
      starsLayer.classList.remove('visible');
      heartsLayer.style.opacity = '0.18';
    }
  }
  themeToggle.addEventListener('click', ()=>{
    applyTheme(theme === 'pink' ? 'night' : 'pink');
  });
  // initial theme
  applyTheme('pink');

  // -- Surprise message --
  function showSurprise(){
    const msg = SURPRISE_MESSAGES[Math.floor(Math.random()*SURPRISE_MESSAGES.length)];
    surpriseText.textContent = msg;
    surprisePopup.classList.add('show');
    setTimeout(()=> surprisePopup.classList.remove('show'), 3200);
  }
  surpriseBtn.addEventListener('click', showSurprise);

  // -- Love letter modal --
  openLetterBtn.addEventListener('click', ()=>{
    letterModal.classList.add('open');
    letterModal.setAttribute('aria-hidden','false');
  });
  closeLetter.addEventListener('click', ()=> {
    letterModal.classList.remove('open');
    letterModal.setAttribute('aria-hidden','true');
  });
  letterModal.addEventListener('click', (e)=>{ if (e.target === letterModal) closeLetter.click(); });

  // -- Load & render gallery (static + user images) --
  function loadUserImages(){
    try{
      return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    }catch(e){ return []; }
  }
  function saveUserImages(arr){
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }catch(e){ console.warn('Could not save images'); }
  }

  function makePolaroid(src, caption = '', isUser=false){
    const card = document.createElement('div');
    card.className = 'polaroid';
    const img = document.createElement('img');
    img.className = 'photo';
    img.src = src;
    img.alt = caption || 'Memory';
    img.loading = 'lazy';
    const meta = document.createElement('div');
    meta.className = 'meta';
    const dateSpan = document.createElement('span');
    dateSpan.className = 'date';
    dateSpan.textContent = `‚Äî ${caption || 'Our memory'}`;
    meta.textContent = caption || '';
    meta.appendChild(dateSpan);

    // click -> open lightbox
    img.addEventListener('click', ()=> openLightbox(src));

    card.appendChild(img);
    card.appendChild(meta);
    return card;
  }

  function initGallery(){
    // preserve existing static images in DOM (first pass)
    const existing = Array.from(document.querySelectorAll('.gallery .polaroid img')).map(i => ({src:i.src, caption: (i.nextElementSibling ? i.nextElementSibling.textContent : '')}));
    gallery.innerHTML = '';
    existing.forEach(it => gallery.appendChild(makePolaroid(it.src, it.caption, false)));
    const users = loadUserImages();
    users.forEach(it => gallery.appendChild(makePolaroid(it.src, it.caption || '')));
  }
  initGallery();

  // -- Add photos from device (with optional caption prompt) --
  fileInput.addEventListener('change', async (e)=>{
    const files = Array.from(e.target.files || []);
    const users = loadUserImages();
    for (const f of files){
      if (!f.type.startsWith('image/')) continue;
      const data = await readFileAsDataURL(f);
      const caption = prompt('Add a short caption for this photo (optional):','') || '';
      users.push({src:data, caption});
    }
    saveUserImages(users);
    initGallery();
    fileInput.value = '';
  });
  function readFileAsDataURL(file){
    return new Promise((res, rej)=>{
      const r = new FileReader();
      r.onload = ()=> res(r.result);
      r.onerror = rej;
      r.readAsDataURL(file);
    });
  }

  // -- Lightbox --
  function openLightbox(src){
    lightboxImg.src = src;
    lightbox.classList.add('open');
    lightbox.setAttribute('aria-hidden','false');
  }
  lightbox.addEventListener('click', ()=> {
    lightbox.classList.remove('open');
    lightbox.setAttribute('aria-hidden','true');
  });

  // -- Slideshow (opens lightbox on timer) --
  startSlideshow.addEventListener('click', ()=>{
    const images = Array.from(document.querySelectorAll('.gallery img')).map(i => i.src);
    if (!images.length) return alert('No images to show.');
    if (slideshowTimer){
      clearInterval(slideshowTimer);
      slideshowTimer = null;
      startSlideshow.textContent = 'Slideshow ‚ñ∂';
      lightbox.classList.remove('open');
    } else {
      let i = 0;
      startSlideshow.textContent = 'Stop ‚è∏';
      openLightbox(images[0]);
      slideshowTimer = setInterval(()=>{
        i = (i+1) % images.length;
        openLightbox(images[i]);
      }, 3600);
    }
  });

  // -- Quiz (interactive) --
  const QUIZ = [
    {q:`Where did ${YOU} and ${HER} take their first photo together?`, options:['The park','At home','The cafe'], a:0},
    {q:`Which song did ${YOU} once say reminds them of ${HER}?`, options:['A slow love song','A pop hit','A sad ballad'], a:0},
    {q:`What is ${HER}‚Äôs favorite snack that ${YOU} always brings?`, options:['Chocolate','Chips','Fruit'], a:0}
  ];
  function startQuiz(){
    quizModal.classList.add('open');
    quizModal.setAttribute('aria-hidden','false');
    renderQuiz(0, 0);
  }
  function renderQuiz(index, score){
    if (index >= QUIZ.length){
      quizContent.innerHTML = `<div style="padding:10px"><h3>Quiz complete!</h3><p style="font-size:1rem">You scored <strong>${score}/${QUIZ.length}</strong></p><p style="margin-top:8px; color:#555">${score === QUIZ.length ? "Perfect memory! You two are in sync ‚ù§Ô∏è" : "So sweet ‚Äî every memory gets better with time."}</p><div style="margin-top:12px; text-align:right;"><button class="btn" id="closeQuizBtn">Close</button></div></div>`;
      document.getElementById('closeQuizBtn').addEventListener('click', ()=> closeQuiz.click());
      return;
    }
    const item = QUIZ[index];
    const html = [`<div style="padding:10px"><p style="font-weight:600">${item.q}</p>`];
    item.options.forEach((opt, idx)=> {
      html.push(`<div style="margin-top:8px"><button class="btn" data-opt="${idx}">${opt}</button></div>`);
    });
    html.push('<div style="margin-top:10px; text-align:right"><button class="btn secondary" id="skipQ">Skip</button></div>');
    html.push('</div>');
    quizContent.innerHTML = html.join('');
    quizContent.querySelectorAll('button[data-opt]').forEach(b=>{
      b.addEventListener('click', ()=>{
        const picked = Number(b.dataset.opt);
        const correct = picked === item.a;
        const newScore = score + (correct?1:0);
        // small feedback
        const feedback = correct ? "Yes! You remembered that right ‚ù§Ô∏è" : "Close ‚Äî but memories grow with time!";
        quizContent.innerHTML = `<div style="padding:14px"><p style="font-weight:600">${feedback}</p><div style="margin-top:10px; text-align:right"><button class="btn" id="nextQ">Next</button></div></div>`;
        document.getElementById('nextQ').addEventListener('click', ()=> renderQuiz(index+1, newScore));
      });
    });
    document.getElementById('skipQ').addEventListener('click', ()=> renderQuiz(index+1, score));
  }
  openQuizBtn.addEventListener('click', startQuiz);
  closeQuiz.addEventListener('click', ()=> {
    quizModal.classList.remove('open');
    quizModal.setAttribute('aria-hidden','true');
  });
  quizModal.addEventListener('click', (e)=>{ if (e.target === quizModal) closeQuiz.click(); });

  // -- Surprise: clicking heart also shows random sweet message (already wired) --
  // showSurprise() defined above

  // -- Keyboard accessibility: Esc to close modals/lightbox --
  document.addEventListener('keydown', (e)=>{
    if (e.key === 'Escape'){
      if (letterModal.classList.contains('open')) closeLetter.click();
      if (quizModal.classList.contains('open')) closeQuiz.click();
      if (lightbox.classList.contains('open')) lightbox.click();
    }
  });

  // -- small utility: download (not zipping due to no server) --
  const downloadBtn = document.getElementById('downloadBtn');
  downloadBtn.addEventListener('click', ()=>{
    alert('Downloading all images from the page isn\'t available offline in one ZIP here. You can right-click images to save or I can add a client-side ZIP feature if you want.');
  });

  // -- Safety: persist default static images as-is, load existing user images --
  // When user adds images already handled above.

  // Expose clear function for debugging in console
  window.album_clear = ()=>{
    if (confirm('Clear saved photos from this browser? (will not delete original files)')){ localStorage.removeItem(STORAGE_KEY); initGallery(); }
  };

  // small UI improvements: clickable header heart -> surprise
  document.querySelector('header').addEventListener('dblclick', showSurprise);

  // For responsiveness: regenerate hearts occasionally to keep motion varied
  setInterval(()=> makeHearts(12 + Math.floor(Math.random()*8)), 20000);

})();
</script>
</body>
</html>
